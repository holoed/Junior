;; var {foldLeft} = require('./Base.js'); var {mkTuple2, fst, snd, empty} = require('./Externals.js'); var {mkTyCon, TyVar, TyLam, isInt, isFloat, isString, isChar} = require('./TypesExternals.js'); var bind = function (m) {  return function (f) {  return function (r) {  return function (s) { var p = ((m (r)) (s)); var s2 = (fst (p)); var x = (snd (p)); return (((f (x)) (r)) (s2)) } } } }; var unit = function (x) {  return function (r) {  return function (s) {  return ((mkTuple2 (s)) (x)) } } }; var ask = function (r) {  return function (s) {  return ((mkTuple2 (s)) (r)) } }; var local = function (f) {  return function (m) {  return function (r) {  return function (s) {  return ((m ((f (r)))) (s)) } } } }; var put = function (s2) {  return function (r) {  return function (s) {  return ((mkTuple2 (s2)) ("()")) } } }; var get = function (r) {  return function (s) {  return ((mkTuple2 (s)) (s)) } }; var runReaderState = function (m) {  return function (r) {  return function (s) {  return ((m (r)) (s)) } } }; var freshName = ((bind (get)) (function (x) {  return ((bind ((put ((x + (1)))))) (function (i2) {  return (unit (("T" + (x)))) })) })); var prettyType = function (t) {  return function() { if ((isTyCon (t))) { var p = (extractTyCon (t)); return (((fst (p)) + (" ")) + ((((foldLeft (function (acc) {  return function (x) {  return (acc + ((prettyType (x)))) } })) ("")) ((snd (p)))))) } else { return function() { if ((isTyVar (t))) { return (extractTyVar (t)) } else { return function() { if ((isTyLam (t))) { var p = (extractTyLam (t)); return (((("(" + ((prettyType ((fst (p)))))) + (" -> ")) + ((prettyType ((snd (p)))))) + (")")) } else { return (error ("This should not happen")) } }() } }() } }() }; var integerCon = ((mkTyCon ("Int")) (empty)); var floatCon = ((mkTyCon ("Float")) (empty)); var charCon = ((mkTyCon ("Char")) (empty)); var stringCon = ((mkTyCon ("String")) (empty)); var literalToType = function (lit) {  return function() { if ((isInt (lit))) { return integerCon } else { return function() { if ((isFloat (lit))) { return floatCon } else { return function() { if ((isChar (lit))) { return charCon } else { return function() { if ((isString (lit))) { return stringCon } else { return (error ("This should not happen")) } }() } }() } }() } }() }; exports.bind = bind; exports.unit = unit; exports.ask = ask; exports.local = local; exports.put = put; exports.get = get; exports.runReaderState = runReaderState; exports.freshName = freshName; exports.prettyType = prettyType; exports.integerCon = integerCon; exports.floatCon = floatCon; exports.charCon = charCon; exports.stringCon = stringCon; exports.literalToType = literalToType; 